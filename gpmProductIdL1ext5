u53Cm01orderCode = 'gpm02/secondMix/53CM01/codOrder'
u53Cm01orderCode = system.tag.readBlocking([u53Cm01orderCode])[0].value
system.util.getLogger('paso0').info('ok')
if newValue.value == 1:
	system.util.getLogger('paso1').info('ok')
	#Consulta por Orden de la Linea 5 - Micropellet
	database = system.tag.readBlocking(["process/general/database"])[0].value #Base de Datos
	#user = system.tag.readBlocking(["[System]Client/User/Username"])[0].value #Base de Datos
	
	queryProd = "Select finalMatId from galProduction where moId like ?" #Consulta por orden que se encuentra en la unidad en este momento
	dataProd = system.db.runPrepQuery(queryProd,[u53Cm01orderCode],database)
	finalMatId = dataProd.getValueAt(0,'finalMatId')
	system.util.getLogger('paso2').info(str(finalMatId))
	tag = "gpm02/secondMix/53Cm01ProdFormulaId" #Variable auxiliar
	tagFinalMatId = tag			
	system.tag.writeAsync([tagFinalMatId],[finalMatId]) #Escribe la Variable Auxiliar en el PLC	
		
	system.tag.writeAsync(["gpm02/secondMix/53CM01ProdFormulaIdFlag"],[0]) #Cambio el estado del tag Flag

