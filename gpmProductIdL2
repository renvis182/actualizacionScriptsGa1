u55orderCode = 'gpm02/secondMix/55CM01/codOrder'
u57orderCode = 'gpm02/secondMix/57CM01/codOrder'
u58orderCode = 'gpm02/secondMix/58CM02/codOrder'
u44Aw01orderCode = 'gpm02/secondMix/44AW01/codOrder'
u44Aw01extLine = 'gpm02/secondMix/44AW01/extLine'

u55orderCode = system.tag.readBlocking([u55orderCode])[0].value
u57orderCode = system.tag.readBlocking([u57orderCode])[0].value
u58orderCode = system.tag.readBlocking([u58orderCode])[0].value
u44Aw01orderCode = system.tag.readBlocking([u44Aw01orderCode])[0].value
u44Aw01extLine = system.tag.readBlocking([u44Aw01extLine])[0].value

if newValue.value == 1:

	#Consulta por Orden de la Linea 9
	database = system.tag.readBlocking(["process/general/database"])[0].value #Base de Datos
	user = system.tag.readBlocking(["[System]Client/User/Username"])[0].value #Base de Datos
	
	#queryProd = "Select finalMatId from galProduction where moId like ?" #Consulta por orden que se encuentra en la unidad en este momento
	queryProd = "Select finalMatId from galProduction where moId like ?" #Consulta por orden que se encuentra en la unidad en este momento
	dataProd = system.db.runPrepQuery(queryProd,[u44Aw01orderCode])
	#finalMatId = dataProd.getValueAt(0, 'finalMatId')
	finalMatId = dataProd.getValueAt(0,'finalMatId')

	if u44Aw01extLine == 7:
		tag = "gpm02/secondMix/55Cm01ProdFormulaId" #Variable auxiliar
		tagFinalMatId = tag			
		system.tag.writeAsync([tagFinalMatId],[finalMatId]) #Escribe la Variable Auxiliar en el PLC
		
	elif u44Aw01extLine == 9:
		tag = "gpm02/secondMix/57Cm01ProdFormulaId" #Variable auxiliar
		tagFinalMatId = tag			
		system.tag.writeAsync([tagFinalMatId],[finalMatId]) #Escribe la Variable Auxiliar en el PLC	

	elif u44Aw01extLine == 10:
		tag = "gpm02/secondMix/58Cm02ProdFormulaId" #Variable auxiliar
		tagFinalMatId = tag			
		system.tag.writeAsync([tagFinalMatId],[finalMatId]) #Escribe la Variable Auxiliar en el PLC	
					
system.tag.writeAsync(["gpm02/secondMix/44Aw01ProdFormulaIdFlag"],[0]) #Cambio el estado del tag Flag
